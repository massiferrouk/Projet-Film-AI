<div class="flex h-screen">
  <div class="w-1/4 bg-gray-100 p-4 overflow-y-auto">
    <h2 class="text-lg font-semibold mb-4">Historique des scénarios</h2>
    <ul class="space-y-2">
      <li 
        *ngFor="let discussion of discussions; let i = index" 
        (click)="selectDiscussion(i)"
        class="p-2 cursor-pointer rounded-md hover:bg-gray-200"
        [class.bg-blue-200]="i === selectedDiscussionIndex"
      >
        {{ discussion.name }}
      </li>
    </ul>
  </div>

  <div class="flex-1 p-6">
    <div class="text-center p-8">
      <h1 class="text-2xl font-bold mb-4">Créez votre propre film avec une IA !</h1>
      <p class="mb-8">Choisissez un style, des personnages et leurs traits, et notre IA générera un scénario unique.</p>

      <div class="mb-8">
        <h2 class="text-xl font-semibold mb-4">1. Choisissez le style de film</h2>
        <div class="flex justify-center space-x-4">
          <app-movie-card
            title="Game of Thrones"
            imgSrc="game-of-thrones1.jpg"
            class="w-40 h-28 rounded-lg shadow-md"
          ></app-movie-card>
          <app-movie-card
            title="Vikings"
            imgSrc="viking.jpg"
            class="w-40 h-28 rounded-lg shadow-md"
          ></app-movie-card>
          <app-movie-card
            title="La Casa de Papel"
            imgSrc="la casa de papel.jpg"
            class="w-40 h-28 rounded-lg shadow-md"
          ></app-movie-card>
        </div>
      </div>

      <div class="mb-8">
        <h2 class="text-xl font-semibold mb-4">2. Définissez vos personnages</h2>
        <p class="mb-4">Choisissez le nombre de personnages pour votre film</p>
        <div class="flex justify-center space-x-4">
          <button
            *ngFor="let num of [1, 2, 3, 4, 5]"
            class="btn"
            [ngClass]="{
              'bg-blue-500 text-white': selectedCharacters === num
            }"
            (click)="updateCharacters(num)"
          >
            {{ num }}
          </button>
        </div>
      </div>

      <div>
        <h2 class="text-xl font-semibold mb-4">3. Listes des personnages</h2>
        <div class="grid grid-cols-2 gap-8">
          <div
            *ngFor="let character of charactersArray; let i = index"
            class="border p-4 rounded shadow"
          >
            <h3 class="font-semibold mb-2">Personnage {{ i + 1 }}</h3>
            <div class="mb-4">
              <label for="name{{ i }}" class="block text-sm font-medium">Nom du personnage</label>
              <input
                id="name{{ i }}"
                type="text"
                class="w-full border rounded px-3 py-1"
                placeholder="Nom du personnage"
              />
            </div>
            <div class="mb-4">
              <label for="trait{{ i }}" class="block text-sm font-medium">Traits de personnalité</label>
              <select
                id="trait{{ i }}"
                class="w-full border rounded px-3 py-1"
              >
                <option value="courageux">Courageux</option>
                <option value="intelligent">Intelligent</option>
                <option value="mystérieux">Mystérieux</option>
              </select>
            </div>
            <div>
              <label for="appearance{{ i }}" class="block text-sm font-medium">Apparence physique</label>
              <select
                id="appearance{{ i }}"
                class="w-full border rounded px-3 py-1"
              >
                <option value="grand">Grand</option>
                <option value="mince">Mince</option>
                <option value="fort">Fort</option>
              </select>
            </div>
          </div>
        </div>
      </div>

      <div class="mb-8">
        <h2 class="text-xl font-semibold mb-4">4. Rédigez votre trame</h2>
        <textarea
          [(ngModel)]="userPlot"
          class="w-full border rounded px-3 py-2"
          placeholder="Décrivez la trame de votre film ici..."
          rows="4"
        ></textarea>
      </div>

      <div class="mt-8 p-6 bg-gray-50 rounded-lg shadow-inner">
        <h2 class="text-xl font-bold mb-4">Scénario généré</h2>
        <div class="border p-4 rounded-md bg-white h-64 overflow-y-auto shadow-md">
          <p *ngIf="selectedDiscussionIndex !== null">
            {{ discussions[selectedDiscussionIndex]?.scenario || 'Aucun scénario généré.' }}
          </p>
          <p *ngIf="selectedDiscussionIndex === null" class="text-gray-500">
            Sélectionnez une discussion à gauche ou générez un nouveau scénario.
          </p>
        </div>

        <button 
          class="mt-4 px-4 py-2 rounded-full bg-blue-500 text-white hover:bg-blue-600 shadow-lg hover:shadow-xl transition-all" 
          (click)="generateNewScenario()"
        >
          Générer un nouveau scénario
        </button>
      </div>
    </div>
  </div>
</div>
